# Pegasus Budget Tracker

## pegasus-backend-api

---

Проект был создан как кладезь имеющихся знаний.

В нем используются последние <!-- возможно --> технологии ведения Java (Kotlin) проектов.

Репозиторий будет увеличиваться и актуализироваться ~~по мере как мне не будет лень~~ как будет время.

---

### Общая структура проекта (WIP)

#### Основные функции

1. Учет доходов и расходов:
    1. Добавление, редактирование и удаление записей о доходах и расходах.
    2. Классификация транзакций по категориям (например, еда, транспорт, развлечения).

2. Управление бюджетом:
    1. Создание и отслеживание бюджета на определенные периоды (месяц, год). WIP
    2. Настройка уведомлений при превышении бюджета. WIP

3. Отчеты и анализ:
    1. Генерация отчетов о доходах и расходах за выбранный период. WIP
    2. Визуализация данных с помощью графиков и диаграмм. WIP

4. Пользователи и безопасность:
    1. Регистрация и аутентификация пользователей.
    2. Создание общей группы (Семья) для отслеживания расходами пользователей.
    3. Разграничение прав доступа (администратор, пользователь). WIP

5. Социальная часть:
    1. Чат

#### Архитектура проекта

1. Слои приложения

    - Слой представления (
      Frontend): [pegasus-budget-tracker-frontend](https://github.com/viad8991/pegasus-budget-tracker-frontend)

    - Слой контроллеров (Controllers/Handlers): Используется Spring Web (Spring MVC) для обработки HTTP-запросов, и
      Spring rSocket для обработки запросов по socket.

    - Сервисный слой (Services): Реализует логику приложения и взаимодействие между контроллерами и репозиториями.

    - Слой данных (Repositories): Используется Spring Data JPA для работы с базой данных.

2. Основные компоненты:

    - Модель данных: Сущности для доходов, расходов, категорий, пользователей и бюджета.
    - Контроллеры: Обрабатывают запросы, связанные с управлением пользователями, транзакциями и отчетами.
    - Сервисы: Отвечают за добавление транзакций, управление бюджетом и генерацию отчетов.
    - Репозитории: Обеспечивают взаимодействие с базой данных.

3. Безопасность:

    - Spring Security: Настроена для защиты приложения, включая аутентификацию и авторизацию с использованием JWT.

4. Логирование и мониторинг:

    - Spring Boot Actuator: Используется для мониторинга состояния приложения и метрик.

---

#### Обязательные зависимости и версии:

1. Java: 21
2. Gradle: latest
3. minikube (+ skaffold): latest

---

#### Полезные команды:

Конечно они не полезные, т.к. все они есть на панели gradle, но основные:

```bash
./gradlew bootRun - локально запустить проект

./gradlew test - локально запустить выполнение тестов

./gradlew rV - проверить наличие вышедших версий зависимостей

minikube start

skaffold run --port-forward

minikube delete

```

---

### TODO

1. Добавить кубовые настройки !!!
2. Добавить чекеры +\-
3. google.cloud.tools.jib
4. Использовать kotlin-dsl для бинов
5. Больше индексов, при значениях >100к записей в таблицах - это уже будет адски тормозить
6. Сделать rSocket роуты в стиле kotlin-bean-dsl
7. Тесты, половина кода уже будет ломаться, как только напишу пару тестов

#### Note.

1. Хотелось бы еще версионизацию прикрутить... Подумаю.
2. Не забыть про профиля
3. Мне уже не нравится идея о FooDto - сущности, которая является как транспортная внутри системы, возникает сильный 
сайд эффект из-за полей, который не должны быть null, а они null... В котлине приветсвуется плодить множество data 
классов, НО...
4. Сущность [Message](org/pegasus/backendapi/chat/model/Message.kt).
   В ней хранится ссылка на `sender: User` и `family: Family`, ХОТЯ пользователи только одной группы могут быть в чате.
   Как корректно реализовать? Оставить `family` для фильтрации, или брать через `user.family`? 

---
